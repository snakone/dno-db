<section id="main">
  <div class="container">
    <!-- Content -->
    <article class="box post">
      <a href="#" class="image featured"><img src="assets/images/pic01.jpg" alt="" /></a>
      <header>
        <h2>DNO Calculators - Enhancement</h2>
        <p>Lorem ipsum dolor sit amet feugiat</p>
      </header>
      <p>
        Vestibulum scelerisque ultricies libero id hendrerit. Vivamus malesuada quam faucibus ante dignissim auctor
        hendrerit libero placerat. Nulla facilisi. Proin aliquam felis non arcu molestie at accumsan turpis commodo.
        Proin elementum, nibh non egestas sodales, augue quam aliquet est, id egestas diam justo adipiscing ante.
        Pellentesque tempus nulla non urna eleifend ut ultrices nisi faucibus.
        Vestibulum scelerisque ultricies libero id hendrerit. Vivamus malesuada quam faucibus ante dignissim auctor
        hendrerit libero placerat. Nulla facilisi. Proin aliquam felis non arcu molestie at accumsan turpis commodo.
        Proin elementum, nibh non egestas sodales, augue quam aliquet est, id egestas diam justo adipiscing ante.
      </p>
      <form>
        <div class="form-control">
          <label for="class">Choose a Class:</label>
          <select name="class" title="class" [(ngModel)]="calculation.class" required>
            <option value="None" disabled selected>Desired Character Class...</option>
            @for(className of classList; track className) {
            <option [value]="className.key">{{className.label}}</option>
            }
          </select>
        </div>
        <div class="form-control">
          <label for="set">Choose a Set:</label>
          <select name="set" title="set" [(ngModel)]="calculation.set">
            <option value="None" disabled selected>Desired Craft Set...</option>
            @for(setName of setList; track setName) {
            <option [value]="setName.key">{{setName.label}}</option>
            }
          </select>
        </div>
        <div class="form-control">
          <label for="set">Choose a Piece:</label>
          <select name="piece" title="piece" [(ngModel)]="calculation.piece">
            <option value="None" disabled selected>Desired Craft Set Piece...</option>
            @for(pieceName of pieceList; track pieceName) {
            <option [value]="pieceName.key">{{pieceName.label}}</option>
            }
            <option value="Full">Full Set</option>
          </select>
        </div>
        <div class="row">
          <div class="col-4">
            <div class="form-control">
              <label for="min">From Grade:</label>
              <input type="number" [(ngModel)]="calculation.from" min="0" max="14" name="min" placeholder="Min 0"
                oninput="this.value = this.value > 14 ? 14 : Math.abs(this.value)" />
            </div>
          </div>
          <div class="col-4">
            <div class="form-control">
              <label for="max">To Grade:</label>
              <input type="number" [(ngModel)]="calculation.to" min="1" max="15" name="max" placeholder="Max 15"
                oninput="this.value = this.value > 15 ? 15 : this.value < 1 ? 1 : Math.abs(this.value)" />
            </div>
          </div>
          <div class="col-4">
            <div class="form-control">
              <label for="jellies">Protection Jellies?</label>
              <select name="jellies" title="jellies" [(ngModel)]="calculation.jellies">
                <option value="false" disabled selected>Are you using this?</option>
                @for(jellyName of jellyList; track jellyName) {
                <option [value]="jellyName.key">{{jellyName.label}}</option>
                }
              </select>
            </div>
          </div>
        </div>
        <div class="row">
          <div class="col-4">
            <div class="form-control">
              <label for="hp">Current HP:</label>
              <input type="number" min="0" name="hp" [(ngModel)]="calculation.hp" placeholder="Your total HP" />
            </div>
          </div>
          <div class="col-4">
            <div class="form-control">
              <label for="mp">Current MP:</label>
              <input type="number" min="0" name="mp" [(ngModel)]="calculation.mp" placeholder="Your total MP" />
            </div>
          </div>
          <div class="col-4">
            <div class="form-control">
              <label for="friendship">Alliance Friendship Bonus?</label>
              <select name="friendship" title="friendship" [(ngModel)]="calculation.friendship">
                <option value="false" disabled selected>Discount Bonus...</option>
                @for(friendName of friendList; track friendName) {
                <option [value]="friendName.key">{{friendName.label}}</option>
                }
              </select>
            </div>
          </div>
        </div>
      </form>
      <button class="button" [disabled]="!calculation.class || 
                          !calculation.set || 
                          !calculation.piece || 
                          calculation.from == undefined ||
                          !calculation.to ||
                          calculation.from >= calculation.to" (click)="calculate();">Calculate!
      </button>
      @if(result$ | async; as result) {
      <div>Success: {{result.totalSuccess}}</div>
      <div>Fails: {{result.totalFails}}</div>
      }
    </article>
  </div>
</section>
